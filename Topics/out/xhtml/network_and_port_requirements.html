<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2019" />
<meta name="DC.rights.owner" content="(C) Copyright 2019" />
<meta name="DC.Type" content="concept" />
<meta name="DC.Title" content="Network and port requirements" />
<meta name="DC.Format" content="XHTML" />
<meta name="DC.Identifier" content="network_and_port_requirements" />
<link rel="stylesheet" type="text/css" href="commonltr.css" />
<title>Network and port requirements</title>
</head>
<body id="network_and_port_requirements">

    <h1 class="title topictitle1" id="ariaid-title1">Network and port requirements</h1>

    <div class="body conbody">
        <p class="p">For proper communication, the IBM StoredIQ components must be able to connect to each
            other. </p>

        <p class="p">You must enable network connectivity from the following locations: </p>

        <div class="p">
            <ul class="ul" id="network_and_port_requirements__ul_t3x_p1l_tjb">
                <li class="li">The data server IP address to the gateway IP address on port 11103</li>

                <li class="li"> The gateway IP address to and from the application stack IP address on port
                    8765 and 5432</li>

                <li class="li">Ports 80, 443, and 22 from the administrative workstation to the application
                    stack and data server IP addresses</li>

                <li class="li">Port 22 from the administrative workstation to the gateway IP address. </li>

            </ul>

        </div>

        <p class="p"><strong class="ph b">TCP: port ranges for the firewall</strong></p>

        <p class="p">To ensure the network access for desktop volumes, the following port ranges must be open
            through a firewall</p>

        <div class="p">
            <ul class="ul" id="network_and_port_requirements__ul_jrk_5bl_tjb">
                <li class="li">21000-21004</li>

                <li class="li">21100-21101 </li>

                <li class="li"> 21110-21130 </li>

                <li class="li">21200-21204 </li>

            </ul>

        </div>

        <p class="p"><strong class="ph b">Default open ports</strong></p>

        <p class="p">The following are open by default on the IBM StoredIQ</p>

        <p class="p"><strong class="ph b">SSH port 22</strong></p>

        <div class="p">By default, port 22 is open on all IBM StoredIQ hosts. The port is used for Secure Shell
            (SSH) communication and allows remote administration access to the VM. In general,
            traffic is encrypted using password authentication. To add a layer of security, you can
            establish key-based authentication for passwordless SSH logins to any of the IBM
            StoredIQ nodes in your environment as described in <span class="xref">"Configuring SSH key-based authentication" on page
                45</span>.
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="network_and_port_requirements__table_yqn_wcl_tjb" class="table" frame="border" border="1" rules="all"><caption><span class="tablecap"><span class="table--title-label">Table 1. </span>Default open ports on the AppStack</span></caption><colgroup><col style="width:50%" /><col style="width:50%" /></colgroup><thead class="thead" style="text-align:left;">
                        <tr class="row">
                            <th class="entry cellrowborder" style="text-align:center;vertical-align:top;" id="d41e97">Port Number</th>

                            <th class="entry cellrowborder" style="text-align:center;vertical-align:top;" id="d41e100">Protocol</th>

                        </tr>

                    </thead>
<tbody class="tbody">
                        <tr class="row">
                            <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e97 ">22</td>

                            <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e100 ">tcp</td>

                        </tr>

                        <tr class="row">
                            <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e97 ">80</td>

                            <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e100 ">tcp</td>

                        </tr>

                        <tr class="row">
                            <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e97 ">443</td>

                            <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e100 ">tcp</td>

                        </tr>

                    </tbody>
</table>
</div>
</div>

        
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="network_and_port_requirements__table_x2k_cdl_tjb" class="table" frame="border" border="1" rules="all"><caption><span class="tablecap"><span class="table--title-label">Table 2. </span>Default open ports on the IBM StoredIQ data server</span></caption><colgroup><col style="width:33.33333333333333%" /><col style="width:33.33333333333333%" /><col style="width:33.33333333333333%" /></colgroup><thead class="thead" style="text-align:left;">
                    <tr class="row">
                        <th class="entry cellrowborder" style="text-align:center;vertical-align:top;" id="d41e154">Port number</th>

                        <th class="entry cellrowborder" style="text-align:center;vertical-align:top;" id="d41e157">Protocol</th>

                        <th class="entry cellrowborder" style="text-align:center;vertical-align:top;" id="d41e160">Service</th>

                    </tr>

                </thead>
<tbody class="tbody">
                    <tr class="row">
                        <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e154 ">22</td>

                        <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e157 ">tcp</td>

                        <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e160 ">PROD-ssh</td>

                    </tr>

                    <tr class="row">
                        <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e154 ">80</td>

                        <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e157 ">tcp</td>

                        <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e160 ">PROD-web</td>

                    </tr>

                    <tr class="row">
                        <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e154 ">443</td>

                        <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e157 ">tcp</td>

                        <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e160 ">PROD-https (UI and Web Services APIs)</td>

                    </tr>

                    <tr class="row">
                        <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e154 ">11103</td>

                        <td class="entry cellrowborder" rowspan="2" style="text-align:center;vertical-align:top;" headers="d41e157 ">tcp</td>

                        <td class="entry cellrowborder" rowspan="2" style="text-align:center;vertical-align:top;" headers="d41e160 ">PROD-transport (IBM StoredIQ transport services;
                            communication between the gateway and the data server)</td>

                    </tr>

                    <tr class="row">
                        <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e154 ">11104</td>

                    </tr>

                </tbody>
</table>
</div>

        <div class="section" id="network_and_port_requirements__section_jz4_qdl_tjb"><h2 class="title sectiontitle">Enable or disable ports os services on the IBM StoredIQ data server</h2>
            
            <div class="p">To manage ports, you can use the
                    <span class="ph filepath">/usr/local/storediq/bin/util/port_handler.pyc </span>script with
                the appropriate
                parameter:<pre class="pre codeblock"><code>python /usr/local/storediq/bin/util/port_handler.pyc -parameter</code></pre></div>

            <p class="p"><strong class="ph b">-s</strong></p>

            <p class="p">To list the current rules in iptables</p>

            <p class="p"><strong class="ph b">-l</strong></p>

            <p class="p">To list the supported services</p>

            <p class="p"><strong class="ph b">-d port_number|'port_range'</strong></p>

            <div class="p">To delete a port or a range of port numbers from iptables, for
                example:<pre class="pre codeblock"><code>python /usr/local/storediq/bin/util/port_handler.pyc -d '21200:21299'
</code></pre></div>

            <p class="p"><strong class="ph b">-e 'service_name'</strong></p>

            <div class="p">To enable a specific service, for example, to enable HTTPS
                services:<pre class="pre codeblock"><code>python /usr/local/storediq/bin/util/port_handler.pyc -e 'PROD-https'</code></pre></div>

            <p class="p"><strong class="ph b">-d 'service_name'</strong></p>

            <div class="p">To disable a specific service, for example, to disable HTTPS
                services:<pre class="pre codeblock"><code>python /usr/local/storediq/bin/util/port_handler.pyc -d 'PROD-https'</code></pre></div>

            
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="network_and_port_requirements__table_efb_bfl_tjb" class="table" frame="border" border="1" rules="all"><caption><span class="tablecap"><span class="table--title-label">Table 3. </span>Default open ports on the nodes in the Elasticsearch cluster</span></caption><colgroup><col style="width:33.33333333333333%" /><col style="width:33.33333333333333%" /><col style="width:33.33333333333333%" /></colgroup><thead class="thead" style="text-align:left;">
                        <tr class="row">
                            <th class="entry cellrowborder" style="text-align:center;vertical-align:top;" id="d41e298">Port Number</th>

                            <th class="entry cellrowborder" style="text-align:center;vertical-align:top;" id="d41e301">Protocol</th>

                            <th class="entry cellrowborder" style="text-align:center;vertical-align:top;" id="d41e304">Service</th>

                        </tr>

                    </thead>
<tbody class="tbody">
                        <tr class="row">
                            <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e298 ">21</td>

                            <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e301 ">tcp</td>

                            <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e304 ">ftp</td>

                        </tr>

                        <tr class="row">
                            <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e298 ">22</td>

                            <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e301 ">tcp</td>

                            <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e304 ">sshd</td>

                        </tr>

                        <tr class="row">
                            <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e298 ">80</td>

                            <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e301 ">tcp</td>

                            <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e304 "> </td>

                        </tr>

                        <tr class="row">
                            <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e298 ">443</td>

                            <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e301 ">tcp</td>

                            <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e304 "> </td>

                        </tr>

                        <tr class="row">
                            <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e298 ">8888</td>

                            <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e301 ">tcp</td>

                            <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e304 ">SimpleHTTPServer (used for copying the<span class="ph filepath">
                                    siq-elasticsearch.yml</span> configuration file from the
                                Elasticsearch node to the data server) </td>

                        </tr>

                        <tr class="row">
                            <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e298 ">9200</td>

                            <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e301 ">tcp6</td>

                            <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e304 ">docker-proxy (listening for REST requests) <p class="p">You can restrict
                                    access to this port by either enabling Search Guard or by
                                    setting up a ³rew\u0004llN For more information, see “Securing
                                    Elasticsearch cluster communication with Search Guard” on page
                                    51 or “Restricting access to port 9200 on Elasticsearch nodes”
                                    on page 52.</p>
</td>

                        </tr>

                        <tr class="row">
                            <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e298 ">9300</td>

                            <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e301 ">tcp6</td>

                            <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e304 ">docker-proxy (internode communication) </td>

                        </tr>

                    </tbody>
</table>
</div>

            <div class="p">
                
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="network_and_port_requirements__table_yvz_qfl_tjb" class="table" frame="border" border="1" rules="all"><caption><span class="tablecap"><span class="table--title-label">Table 4. </span>Default open ports on the IBM StoredIQ gateway</span></caption><colgroup><col style="width:33.33333333333333%" /><col style="width:33.33333333333333%" /><col style="width:33.33333333333333%" /></colgroup><thead class="thead" style="text-align:left;">
                            <tr class="row">
                                <th class="entry cellrowborder" style="text-align:center;vertical-align:top;" id="d41e421">Port number</th>

                                <th class="entry cellrowborder" style="text-align:center;vertical-align:top;" id="d41e424">Protocol</th>

                                <th class="entry cellrowborder" style="text-align:center;vertical-align:top;" id="d41e427">Service</th>

                            </tr>

                        </thead>
<tbody class="tbody">
                            <tr class="row">
                                <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e421 ">22</td>

                                <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e424 ">tcp</td>

                                <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e427 ">PROD-ssh</td>

                            </tr>

                            <tr class="row">
                                <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e421 ">80</td>

                                <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e424 ">tcp</td>

                                <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e427 ">PROD-web</td>

                            </tr>

                            <tr class="row">
                                <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e421 ">443</td>

                                <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e424 ">tcp</td>

                                <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e427 ">PROD-https(UI and Web Services APIs</td>

                            </tr>

                            <tr class="row">
                                <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e421 ">5432</td>

                                <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e424 ">tcp</td>

                                <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e427 ">PROD-postgres</td>

                            </tr>

                            <tr class="row">
                                <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e421 ">5434</td>

                                <td class="entry cellrowborder" rowspan="6" style="text-align:center;vertical-align:top;" headers="d41e424 ">tcp</td>

                                <td class="entry cellrowborder" rowspan="6" style="text-align:center;vertical-align:top;" headers="d41e427 ">PROD-transport (IBM StoredIQ transport services;
                                    communications between the gateway and the data server)</td>

                            </tr>

                            <tr class="row">
                                <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e421 ">8765</td>

                            </tr>

                            <tr class="row">
                                <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e421 ">7766</td>

                            </tr>

                            <tr class="row">
                                <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e421 ">11102</td>

                            </tr>

                            <tr class="row">
                                <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e421 ">11103</td>

                            </tr>

                            <tr class="row">
                                <td class="entry cellrowborder" style="text-align:center;vertical-align:top;" headers="d41e421 ">11104</td>

                            </tr>

                        </tbody>
</table>
</div>

            </div>

        </div>

        <div class="section" id="network_and_port_requirements__section_s2l_ggl_tjb"><h2 class="title sectiontitle">Supported chain and rules on the IBM StoredIQ gateway</h2>
            
            <div class="p">In iptables, the following firewall and chain rules are
                defined:<pre class="pre codeblock"><code>'PROD-transport':['5434','8765','7766','11102','11103','11104'],
 'PROD-https':['443'],
 'PROD-ssh':['22'],
 'PROD-web':['80'],
 'PROD-postgres':[’5432’]
</code></pre><pre class="pre codeblock"><code>'desktop' service:
                         'PROD-broker':['21000'],
                         'PROD-collectionsvc':['21300:21399'],
                         'PROD-desktopupgrade':['21004'],
                         'PROD-objlistmgr':['21100:21199'],
                         'PROD-objlistsvc':['21200:21299'],
                         'PROD-registration':['21001'],
                         'PROD-session':['21002'],
                         'PROD-task':['21003'],
</code></pre>
            </div>

        </div>

        <div class="section" id="network_and_port_requirements__section_pcc_rgl_tjb"><h2 class="title sectiontitle">Open ports for desktop client access to the data server</h2>
            
            <div class="p">To open ports for desktop client access to the data server on OVA deployed systems,
                follow these steps:<ol class="ol" id="network_and_port_requirements__ol_isj_5gl_tjb">
                    <li class="li">Log in to the data server as root and run this
                        command:<pre class="pre codeblock"><code>python /usr/local/storediq/bin/util/port_handler.pyc -e desktop</code></pre></li>

                    <li class="li">Run this command:<code class="ph codeph">iptables -L INPUT</code><p class="p">In the output of the
                            command, check the list position of the rule that is named
                                <code class="ph codeph">PROD-reject</code>, for example, the 6th position on the
                            list.</p>
</li>

                    <li class="li">Run this command: <code class="ph codeph">iptables -A INPUT -j PROD-reject</code>
                    </li>

                    <li class="li">Run this command: <code class="ph codeph">iptables -D INPUT
                                list_position</code><p class="p"><code class="ph codeph">list_position</code> is the
                            position number of the <code class="ph codeph">PROD-reject</code> rule that you
                            determined in step 2.</p>
</li>

                    <li class="li">Run the following
                        command:<pre class="pre codeblock"><code>python /usr/local/storediq/bin/util/port_handler.pyc -e desktop
</code></pre></li>

                </ol>
<strong class="ph b">Tip:</strong> These steps are required only on an IBM StoredIQ OVA deployed
                system. The correct ports are open on an upgraded system.</div>

        </div>

    </div>

</body>
</html>